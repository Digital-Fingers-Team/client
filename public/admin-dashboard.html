<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة تحكم المدير - DT Edu</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #4a6cf7;
            --primary-dark: #3a56d4;
            --secondary: #6c5ce7;
            --accent: #00b894;
            --light: #f8f9fa;
            --dark: #2d3436;
            --text: #333;
            --text-light: #666;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
            --sidebar-width: 260px;
        }

        .dark-mode {
            --light: #1a1a2e;
            --dark: #f8f9fa;
            --text: #e6e6e6;
            --text-light: #b0b0b0;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Tajawal', 'Segoe UI', sans-serif;
        }

        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #f0f8ff 0%, #e1f0fa 100%);
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            transition: var(--transition);
        }

        body.dark-mode {
            background: linear-gradient(135deg, #16213e 0%, #0f3460 100%);
        }

        body.rtl {
            direction: rtl;
        }

        body.ltr {
            direction: ltr;
        }

        /* التصميم الرئيسي */
        .dashboard-container {
            display: flex;
            min-height: 100vh;
        }

        /* الشريط الجانبي */
        .sidebar {
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 20px 0;
            box-shadow: var(--shadow);
            z-index: 100;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: var(--transition);
        }

        /* عندما تكون اللغة عربية */
        body.rtl .sidebar {
            right: 0;
        }

        body.rtl .main-content {
            margin-right: var(--sidebar-width);
        }

        /* عندما تكون اللغة إنجليزية */
        body.ltr .sidebar {
            left: 0;
        }

        body.ltr .main-content {
            margin-left: var(--sidebar-width);
            margin-right: 0;
        }

        .sidebar-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 20px;
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
        }

        .logo {
            width: 70px;
            height: 70px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .logo svg {
            width: 50px;
            height: 50px;
        }

        .logo-text {
            font-size: 24px;
            font-weight: 800;
            background: linear-gradient(135deg, white, #e1f0fa);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .user-info {
            text-align: center;
            margin-top: 10px;
        }

        .user-name {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 5px;
        }

        .user-type {
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
            display: inline-block;
        }

        .sidebar-menu {
            list-style: none;
            padding: 0 15px;
            margin-bottom: 20px;
        }

        .menu-item {
            margin-bottom: 8px;
            border-radius: 10px;
            overflow: hidden;
        }

        .menu-item a {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            color: white;
            text-decoration: none;
            transition: var(--transition);
        }

        .menu-item a:hover,
        .menu-item.active a {
            background: rgba(255, 255, 255, 0.15);
        }

        body.rtl .menu-item a:hover,
        body.rtl .menu-item.active a {
            transform: translateX(-5px);
        }

        body.ltr .menu-item a:hover,
        body.ltr .menu-item.active a {
            transform: translateX(5px);
        }

        .menu-item i {
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        body.rtl .menu-item i {
            margin-left: 10px;
        }

        body.ltr .menu-item i {
            margin-right: 10px;
        }

        .menu-item span {
            flex: 1;
        }

        .sidebar-footer {
            padding: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            margin-top: auto;
        }

        .sidebar-footer .menu-item a {
            padding: 10px 15px;
        }

        /* المحتوى الرئيسي */
        .main-content {
            flex: 1;
            padding: 20px;
            transition: var(--transition);
        }

        .header {
            background: white;
            border-radius: 15px;
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }

        body.dark-mode .header {
            background: var(--light);
            color: var(--dark);
        }

        .header h1 {
            color: var(--primary);
            font-size: 28px;
            font-weight: 700;
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .dark-mode-toggle,
        .logout-btn {
            padding: 10px 15px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .dark-mode-toggle {
            background: rgba(74, 108, 247, 0.1);
            color: var(--primary);
        }

        .dark-mode-toggle:hover {
            background: rgba(74, 108, 247, 0.2);
        }

        .logout-btn {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
        }

        .logout-btn:hover {
            background: rgba(231, 76, 60, 0.2);
        }

        /* بطاقات الإحصائيات */
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            box-shadow: var(--shadow);
            padding: 25px;
            display: flex;
            align-items: center;
            transition: var(--transition);
        }

        body.dark-mode .stat-card {
            background: var(--light);
            color: var(--dark);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }

        body.rtl .stat-icon {
            margin-left: 15px;
        }

        body.ltr .stat-icon {
            margin-right: 15px;
        }

        .stat-info {
            flex: 1;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--text-light);
            font-size: 14px;
        }

        /* الشبكة الرئيسية */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: white;
            border-radius: 15px;
            box-shadow: var(--shadow);
            padding: 25px;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        body.dark-mode .dashboard-card {
            background: var(--light);
            color: var(--dark);
        }

        .dashboard-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            background: var(--primary);
        }

        body.rtl .card-icon {
            margin-left: 15px;
        }

        body.ltr .card-icon {
            margin-right: 15px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text);
        }

        .card-content {
            color: var(--text-light);
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .card-actions {
            display: flex;
            justify-content: flex-end;
        }

        .card-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        /* قسم التقارير */
        .reports-section {
            background: white;
            border-radius: 15px;
            box-shadow: var(--shadow);
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
        }

        body.dark-mode .reports-section {
            background: var(--light);
            color: var(--dark);
        }

        .reports-title {
            color: var(--primary);
            font-size: 24px;
            margin-bottom: 15px;
        }

        .reports-description {
            color: var(--text-light);
            margin-bottom: 25px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .reports-btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(74, 108, 247, 0.4);
        }

        .reports-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(74, 108, 247, 0.6);
        }

        /* النوافذ المنبثقة */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-content {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 30px;
            position: relative;
            animation: modalFadeIn 0.3s ease-out;
        }

        body.dark-mode .modal-content {
            background-color: var(--light);
            color: var(--dark);
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .close-btn {
            position: absolute;
            top: 20px;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-light);
            transition: var(--transition);
        }

        body.rtl .close-btn {
            left: 25px;
        }

        body.ltr .close-btn {
            right: 25px;
        }

        .close-btn:hover {
            color: var(--text);
        }

        .modal-title {
            color: var(--primary);
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
            font-size: 24px;
        }

        body.dark-mode .modal-title {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* تصاميم خاصة بالمحتوى التفاعلي */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text);
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: var(--transition);
            background-color: #f8f9fa;
        }

        body.dark-mode .form-group input,
        body.dark-mode .form-group textarea,
        body.dark-mode .form-group select {
            background-color: var(--light);
            color: var(--dark);
            border-color: rgba(255, 255, 255, 0.1);
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            border-color: var(--primary);
            background-color: white;
            outline: none;
            box-shadow: 0 0 0 3px rgba(74, 108, 247, 0.2);
        }

        body.dark-mode .form-group input:focus,
        body.dark-mode .form-group textarea:focus,
        body.dark-mode .form-group select:focus {
            background-color: var(--light);
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-btn {
            display: block;
            padding: 12px 15px;
            background: rgba(74, 108, 247, 0.1);
            color: var(--primary);
            border: 2px dashed var(--primary);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .file-input-btn:hover {
            background: rgba(74, 108, 247, 0.2);
        }

        .submit-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .submit-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .content-list {
            list-style: none;
            margin-top: 15px;
        }

        .content-item {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }

        body.dark-mode .content-item {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .content-item:hover {
            background: rgba(74, 108, 247, 0.05);
        }

        .content-item:last-child {
            border-bottom: none;
        }

        .content-name {
            font-weight: 600;
            color: var(--text);
        }

        .content-meta {
            display: flex;
            gap: 15px;
            color: var(--text-light);
            font-size: 14px;
        }

        .content-actions {
            display: flex;
            gap: 10px;
        }

        .content-btn {
            background: rgba(74, 108, 247, 0.1);
            color: var(--primary);
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: var(--transition);
        }

        .content-btn:hover {
            background: rgba(74, 108, 247, 0.2);
        }

        .attendance-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .attendance-table th,
        .attendance-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        body.rtl .attendance-table th,
        body.rtl .attendance-table td {
            text-align: right;
        }

        body.ltr .attendance-table th,
        body.ltr .attendance-table td {
            text-align: left;
        }

        body.dark-mode .attendance-table th,
        body.dark-mode .attendance-table td {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .attendance-table th {
            background: rgba(74, 108, 247, 0.1);
            color: var(--primary);
            font-weight: 600;
        }

        .status-btn {
            padding: 6px 12px;
            border-radius: 6px;
            border: none;
            font-size: 12px;
            cursor: pointer;
            transition: var(--transition);
        }

        .status-present {
            background: rgba(0, 184, 148, 0.1);
            color: #00b894;
        }

        .status-absent {
            background: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
        }

        .status-late {
            background: rgba(243, 156, 18, 0.1);
            color: #f39c12;
        }

        .status-btn:hover {
            opacity: 0.8;
        }

        .chart-container {
            margin-top: 20px;
            height: 300px;
            position: relative;
        }

        .message-area {
            width: 100%;
            height: 150px;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: var(--transition);
            background-color: #f8f9fa;
            resize: vertical;
        }

        body.dark-mode .message-area {
            background-color: var(--light);
            color: var(--dark);
            border-color: rgba(255, 255, 255, 0.1);
        }

        .message-area:focus {
            border-color: var(--primary);
            background-color: white;
            outline: none;
            box-shadow: 0 0 0 3px rgba(74, 108, 247, 0.2);
        }

        body.dark-mode .message-area:focus {
            background-color: var(--light);
        }

        /* التصميم المتجاوب */
        @media (max-width: 1200px) {
            .dashboard-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }

        @media (max-width: 992px) {
            .sidebar {
                width: 80px;
            }

            .sidebar-header .logo-text,
            .user-info,
            .menu-item span {
                display: none;
            }

            body.rtl .main-content {
                margin-right: 80px;
            }

            body.ltr .main-content {
                margin-left: 80px;
            }

            .menu-item a {
                justify-content: center;
                padding: 15px;
            }

            .menu-item i {
                margin: 0;
                font-size: 20px;
            }

            .sidebar-footer .menu-item span {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .stats-cards {
                grid-template-columns: 1fr;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .header-actions {
                justify-content: center;
            }

            .content-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .content-meta {
                flex-direction: column;
                gap: 5px;
            }

            .content-actions {
                align-self: flex-end;
            }
        }

        @media (max-width: 576px) {
            .main-content {
                padding: 15px;
            }

            .modal-content {
                padding: 20px;
                width: 95%;
            }

            .sidebar {
                width: 70px;
            }

            body.rtl .main-content {
                margin-right: 70px;
            }

            body.ltr .main-content {
                margin-left: 70px;
            }
        }
    </style>
</head>

<body class="rtl">
    <div class="dashboard-container">
        <!-- الشريط الجانبي -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo-container">
                    <div class="logo">
                        <!-- الشعار داخل دائرة بيضاء -->
                        <svg width="50" height="50" viewBox="0 0 96 96" xmlns="http://www.w3.org/2000/svg">
                            <defs>
                                <linearGradient id="grad" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" stop-color="#4a6cf7" />
                                    <stop offset="100%" stop-color="#00b894" />
                                </linearGradient>
                            </defs>
                            <circle cx="48" cy="48" r="46" fill="url(#grad)" opacity="0.15" stroke="#4a6cf7"
                                stroke-width="2" />
                            <path d="M28 62C28 48.745 38.745 38 52 38H60V46H52C43.163 46 36 53.163 36 62H28Z"
                                fill="#4a6cf7" />
                            <path d="M40 58C40 44.745 50.745 34 64 34H72V42H64C55.163 42 48 49.163 48 58H40Z"
                                fill="#00b894" opacity="0.85" />
                            <circle cx="60" cy="32" r="8" fill="#4a6cf7" opacity="0.75" />
                            <circle cx="36" cy="60" r="6" fill="#00b894" opacity="0.8" />
                        </svg>
                    </div>
                </div>
                <div class="logo-text">DT Edu</div>
                <div class="user-info">
                    <div class="user-name" id="user-name">مدير النظام</div>
                    <div class="user-type" id="user-type">مدير</div>
                </div>
            </div>

            <ul class="sidebar-menu">
                <li class="menu-item active">
                    <a href="admin-dashboard.html">
                        <i class="fas fa-home"></i>
                        <span id="menu-dashboard">لوحة التحكم</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="admin-users.html">
                        <i class="fas fa-users-cog"></i>
                        <span id="menu-users">إدارة المستخدمين</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="admin-reports.html">
                        <i class="fas fa-chart-bar"></i>
                        <span id="menu-reports">التقارير والإحصائيات</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="admin-schedule.html">
                        <i class="fas fa-calendar-alt"></i>
                        <span id="menu-schedule">الجدول المدرسي</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="admin-settings.html">
                        <i class="fas fa-cogs"></i>
                        <span id="menu-settings">إعدادات النظام</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a href="admin-messages.html">
                        <i class="fas fa-comments"></i>
                        <span id="menu-messages">الرسائل</span>
                    </a>
                </li>
            </ul>

            <div class="sidebar-footer">
                <ul class="sidebar-menu">
                    <li class="menu-item">
                        <a href="#" id="sidebar-dark-mode-toggle">
                            <i class="fas fa-moon"></i>
                            <span id="dark-mode-text">الوضع الداكن</span>
                        </a>
                    </li>
                    <li class="menu-item">
                        <a href="#" id="logout-link">
                            <i class="fas fa-sign-out-alt"></i>
                            <span id="logout-text">تسجيل الخروج</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>

        <!-- المحتوى الرئيسي -->
        <div class="main-content">
            <div class="header">
                <h1 id="header-title">لوحة تحكم المدير - نظام DT Edu</h1>
                <div class="header-actions">
                    <button class="dark-mode-toggle" id="header-dark-mode-toggle">
                        <i class="fas fa-moon"></i>
                        <span id="dark-mode-btn-text">الوضع الداكن</span>
                    </button>
                    <button class="logout-btn" id="header-logout-btn">
                        <i class="fas fa-sign-out-alt"></i>
                        <span id="header-logout-text">تسجيل الخروج</span>
                    </button>
                </div>
            </div>

            <!-- محتوى خاص بالمدير -->
            <div id="admin-content" class="user-specific-content active">
                <!-- بطاقات الإحصائيات للمدير -->
                <div class="stats-cards">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #4a6cf7, #6c5ce7);">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="users-count">0</div>
                            <div class="stat-label" id="admin-students-stat">عدد المستخدمين</div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #00b894, #00a085);">
                            <i class="fas fa-book"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="courses-count">0</div>
                            <div class="stat-label" id="admin-teachers-stat">عدد الدورات</div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #fd79a8, #e84393);">
                            <i class="fas fa-user-check"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="enrollments-count">0</div>
                            <div class="stat-label" id="admin-classes-stat">عدد التسجيلات</div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #fdcb6e, #e17055);">
                            <i class="fas fa-comments"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="messages-count">0</div>
                            <div class="stat-label" id="admin-performance-stat">عدد الرسائل</div>
                        </div>
                    </div>
                </div>

                <!-- الشبكة الرئيسية للمدير -->
                <div class="dashboard-grid">
                    <!-- بطاقة 1: إدارة المستخدمين -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon" style="background: linear-gradient(135deg, #4a6cf7, #6c5ce7);">
                                <i class="fas fa-user-cog"></i>
                            </div>
                            <div class="card-title" id="admin-users-card">إدارة المستخدمين</div>
                        </div>
                        <div class="card-content" id="admin-users-desc">
                            إدارة حسابات الطلاب والمعلمين وأولياء الأمور.
                        </div>
                        <div class="card-actions">
                            <button class="card-btn" id="admin-users-btn" onclick="openUsersModal()">
                                <i class="fas fa-cog"></i>
                                <span>إدارة</span>
                            </button>
                        </div>
                    </div>

                    <!-- بطاقة 2: التقارير والإحصائيات -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon" style="background: linear-gradient(135deg, #00b894, #00a085);">
                                <i class="fas fa-chart-bar"></i>
                            </div>
                            <div class="card-title" id="admin-reports-card">التقارير والإحصائيات</div>
                        </div>
                        <div class="card-content" id="admin-reports-desc">
                            عرض التقارير والإحصائيات الشاملة للمدرسة.
                        </div>
                        <div class="card-actions">
                            <button class="card-btn" id="admin-reports-btn" onclick="openReportsModal()">
                                <i class="fas fa-file-alt"></i>
                                <span>عرض</span>
                            </button>
                        </div>
                    </div>

                    <!-- بطاقة 3: مراجعة التحضير -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon" style="background: linear-gradient(135deg, #fd79a8, #e84393);">
                                <i class="fas fa-file-check"></i>
                            </div>
                            <div class="card-title" id="admin-prep-card">مراجعة التحضير</div>
                        </div>
                        <div class="card-content" id="admin-prep-desc">
                            مراجعة وتحضير الدروس المرفوعة من المعلمين.
                        </div>
                        <div class="card-actions">
                            <button class="card-btn" id="admin-prep-btn" onclick="openPrepReviewModal()">
                                <i class="fas fa-check-circle"></i>
                                <span>مراجعة</span>
                            </button>
                        </div>
                    </div>

                    <!-- بطاقة 4: إعدادات النظام -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon" style="background: linear-gradient(135deg, #fdcb6e, #e17055);">
                                <i class="fas fa-cogs"></i>
                            </div>
                            <div class="card-title" id="admin-settings-card">إعدادات النظام</div>
                        </div>
                        <div class="card-content" id="admin-settings-desc">
                            إعدادات النظام العامة وإدارة الصلاحيات.
                        </div>
                        <div class="card-actions">
                            <button class="card-btn" id="admin-settings-btn" onclick="openSettingsModal()">
                                <i class="fas fa-sliders-h"></i>
                                <span>إعدادات</span>
                            </button>
                        </div>
                    </div>

                    <!-- بطاقة 5: الجدول المدرسي -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon" style="background: linear-gradient(135deg, #a29bfe, #6c5ce7);">
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                            <div class="card-title" id="admin-schedule-card">الجدول المدرسي</div>
                        </div>
                        <div class="card-content" id="admin-schedule-desc">
                            إدارة الجداول الدراسية وتوزيع الحصص.
                        </div>
                        <div class="card-actions">
                            <button class="card-btn" id="admin-schedule-btn" onclick="openScheduleModal()">
                                <i class="fas fa-edit"></i>
                                <span>إدارة</span>
                            </button>
                        </div>
                    </div>

                    <!-- بطاقة 6: التواصل -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <div class="card-icon" style="background: linear-gradient(135deg, #81ecec, #00cec9);">
                                <i class="fas fa-comments"></i>
                            </div>
                            <div class="card-title" id="admin-messaging-card">التواصل</div>
                        </div>
                        <div class="card-content" id="admin-messaging-desc">
                            التواصل مع المعلمين والطلاب وأولياء الأمور.
                        </div>
                        <div class="card-actions">
                            <button class="card-btn" id="admin-messaging-btn" onclick="openMessagingModal()">
                                <i class="fas fa-comment"></i>
                                <span>مراسلة</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- قسم التقارير -->
            <div class="reports-section">
                <h2 class="reports-title" id="reports-title">التقارير الشاملة</h2>
                <p class="reports-description" id="reports-desc">
                    قم بمراجعة التقارير الشاملة للمدرسة وإحصائيات الأداء للطلاب والمعلمين.
                </p>
                <button class="reports-btn" id="reports-btn" onclick="openReportsModal()">
                    <i class="fas fa-chart-bar"></i>
                    <span>عرض التقارير الشاملة</span>
                </button>
            </div>
        </div>
    </div>

    <!-- النوافذ المنبثقة -->

    <!-- نافذة إدارة المستخدمين -->
    <div id="users-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('users-modal')">&times;</span>
            <h2 class="modal-title" id="users-title">إدارة المستخدمين</h2>
            <div id="users-content">
                <div class="form-group">
                    <label for="user-type-filter">تصفية حسب النوع:</label>
                    <select id="user-type-filter">
                        <option value="all">جميع المستخدمين</option>
                        <option value="student">الطلاب</option>
                        <option value="teacher">المعلمين</option>
                        <option value="parent">أولياء الأمور</option>
                    </select>
                </div>
                <div class="card-actions" style="margin-bottom: 20px;">
                    <button class="card-btn" onclick="openAddUserModal()">
                        <i class="fas fa-plus"></i>
                        <span>إضافة مستخدم جديد</span>
                    </button>
                </div>
                <ul class="content-list" id="users-list">
                    <!-- سيتم تعبئته بالجافاسكريبت -->
                </ul>
            </div>
        </div>
    </div>

    <!-- نافذة التقارير والإحصائيات -->
    <div id="reports-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('reports-modal')">&times;</span>
            <h2 class="modal-title" id="reports-modal-title">التقارير والإحصائيات</h2>
            <div id="reports-content">
                <div class="form-group">
                    <label for="report-type">نوع التقرير:</label>
                    <select id="report-type">
                        <option value="performance">أداء الطلاب</option>
                        <option value="attendance">الحضور والغياب</option>
                        <option value="teachers">أداء المعلمين</option>
                        <option value="financial">التقارير المالية</option>
                    </select>
                </div>
                <div class="chart-container">
                    <canvas id="reports-chart"></canvas>
                </div>
                <div class="form-group" style="margin-top: 20px;">
                    <label for="report-period">الفترة الزمنية:</label>
                    <select id="report-period">
                        <option value="week">آخر أسبوع</option>
                        <option value="month">آخر شهر</option>
                        <option value="semester">الفصل الدراسي</option>
                        <option value="year">السنة الدراسية</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <!-- نافذة مراجعة التحضير -->
    <div id="prep-review-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('prep-review-modal')">&times;</span>
            <h2 class="modal-title" id="prep-review-title">مراجعة التحضير</h2>
            <div id="prep-review-content">
                <div class="form-group">
                    <label for="prep-filter">تصفية حسب:</label>
                    <select id="prep-filter">
                        <option value="pending">في انتظار المراجعة</option>
                        <option value="approved">تمت الموافقة</option>
                        <option value="rejected">مرفوض</option>
                        <option value="all">جميع التحضيرات</option>
                    </select>
                </div>
                <ul class="content-list" id="prep-list">
                    <!-- سيتم تعبئته بالجافاسكريبت -->
                </ul>
            </div>
        </div>
    </div>

    <!-- نافذة إعدادات النظام -->
    <div id="settings-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('settings-modal')">&times;</span>
            <h2 class="modal-title" id="settings-title">إعدادات النظام</h2>
            <div id="settings-content">
                <div class="form-group">
                    <label for="system-name">اسم النظام:</label>
                    <input type="text" id="system-name" value="DT Edu">
                </div>
                <div class="form-group">
                    <label for="school-name">اسم المدرسة:</label>
                    <input type="text" id="school-name" value="مدرسة المستقبل">
                </div>
                <div class="form-group">
                    <label for="academic-year">السنة الدراسية:</label>
                    <input type="text" id="academic-year" value="2023/2024">
                </div>
                <div class="form-group">
                    <label for="language-setting">لغة النظام:</label>
                    <select id="language-setting">
                        <option value="ar">العربية</option>
                        <option value="en">الإنجليزية</option>
                    </select>
                </div>
                <div class="form-group">
                    <button class="submit-btn" onclick="saveSettings()">
                        <i class="fas fa-save"></i>
                        <span>حفظ الإعدادات</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- نافذة إدارة الجدول المدرسي -->
    <div id="schedule-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('schedule-modal')">&times;</span>
            <h2 class="modal-title" id="schedule-title">إدارة الجدول المدرسي</h2>
            <div id="schedule-content">
                <div class="form-group">
                    <label for="class-filter">اختر الفصل:</label>
                    <select id="class-filter">
                        <option value="1">الصف الأول</option>
                        <option value="2">الصف الثاني</option>
                        <option value="3">الصف الثالث</option>
                        <option value="4">الصف الرابع</option>
                        <option value="5">الصف الخامس</option>
                        <option value="6">الصف السادس</option>
                    </select>
                </div>
                <div class="attendance-table">
                    <table>
                        <thead>
                            <tr>
                                <th>اليوم</th>
                                <th>الحصة الأولى</th>
                                <th>الحصة الثانية</th>
                                <th>الحصة الثالثة</th>
                                <th>الحصة الرابعة</th>
                                <th>الحصة الخامسة</th>
                            </tr>
                        </thead>
                        <tbody id="schedule-table-body">
                            <!-- سيتم تعبئته بالجافاسكريبت -->
                        </tbody>
                    </table>
                </div>
                <div class="card-actions" style="margin-top: 20px;">
                    <button class="card-btn" onclick="editSchedule()">
                        <i class="fas fa-edit"></i>
                        <span>تعديل الجدول</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- نافذة التواصل -->
    <div id="messaging-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('messaging-modal')">&times;</span>
            <h2 class="modal-title" id="messaging-title">التواصل</h2>
            <div id="messaging-content">
                <div class="form-group">
                    <label for="message-recipient">المستلم</label>
                    <select id="message-recipient">
                        <option value="">اختر المستلم</option>
                        <option value="all-teachers">جميع المعلمين</option>
                        <option value="all-students">جميع الطلاب</option>
                        <option value="all-parents">جميع أولياء الأمور</option>
                        <option value="specific">مستلم محدد</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="message-subject">عنوان الرسالة</label>
                    <input type="text" id="message-subject" placeholder="أدخل عنوان الرسالة">
                </div>
                <div class="form-group">
                    <label for="message-content">نص الرسالة</label>
                    <textarea class="message-area" id="message-content" placeholder="اكتب رسالتك هنا..."></textarea>
                </div>
                <div class="form-group">
                    <button class="submit-btn" onclick="sendMessage()">
                        <i class="fas fa-paper-plane"></i>
                        <span>إرسال الرسالة</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- نافذة إضافة مستخدم جديد -->
    <div id="add-user-modal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('add-user-modal')">&times;</span>
            <h2 class="modal-title">إضافة مستخدم جديد</h2>
            <div id="add-user-content">
                <div class="form-group">
                    <label for="new-user-name">الاسم الكامل:</label>
                    <input type="text" id="new-user-name" placeholder="أدخل الاسم الكامل">
                </div>
                <div class="form-group">
                    <label for="new-user-email">البريد الإلكتروني:</label>
                    <input type="email" id="new-user-email" placeholder="أدخل البريد الإلكتروني">
                </div>
                <div class="form-group">
                    <label for="new-user-type">نوع المستخدم:</label>
                    <select id="new-user-type">
                        <option value="student">طالب</option>
                        <option value="teacher">معلم</option>
                        <option value="parent">ولي أمر</option>
                    </select>
                </div>
                <div class="form-group" id="class-group" style="display: none;">
                    <label for="new-user-class">الصف:</label>
                    <select id="new-user-class">
                        <option value="الصف الأول">الصف الأول</option>
                        <option value="الصف الثاني">الصف الثاني</option>
                        <option value="الصف الثالث">الصف الثالث</option>
                        <option value="الصف الرابع">الصف الرابع</option>
                        <option value="الصف الخامس">الصف الخامس</option>
                        <option value="الصف السادس">الصف السادس</option>
                    </select>
                </div>
                <div class="form-group" id="subject-group" style="display: none;">
                    <label for="new-user-subject">المادة:</label>
                    <input type="text" id="new-user-subject" placeholder="أدخل المادة">
                </div>
                <div class="form-group" id="student-group" style="display: none;">
                    <label for="new-user-student">الطالب:</label>
                    <input type="text" id="new-user-student" placeholder="أدخل اسم الطالب">
                </div>
                <div class="form-group">
                    <button class="submit-btn" onclick="addNewUser()">
                        <i class="fas fa-plus"></i>
                        <span>إضافة المستخدم</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // بيانات المثال للمدير
        const users = [
            { id: 1, name: "أحمد الطالب", type: "student", class: "الصف الأول", status: "active" },
            { id: 2, name: "محمد المعلم", type: "teacher", subject: "الرياضيات", status: "active" },
            { id: 3, name: "سعيد ولي الأمر", type: "parent", student: "أحمد الطالب", status: "active" },
            { id: 4, name: "فاطمة الطالبة", type: "student", class: "الصف الثاني", status: "inactive" },
            { id: 5, name: "ليلى المعلمة", type: "teacher", subject: "اللغة العربية", status: "active" }
        ];

        const preparationMaterials = [
            { id: 1, teacher: "محمد المعلم", subject: "الرياضيات", title: "تحضير درس الجبر", date: "2023-10-20", status: "pending" },
            { id: 2, teacher: "ليلى المعلمة", subject: "اللغة العربية", title: "تحضير درس النحو", date: "2023-10-19", status: "approved" },
            { id: 3, teacher: "سالم المعلم", subject: "العلوم", title: "تحضير درس التفاعلات الكيميائية", date: "2023-10-18", status: "rejected" },
            { id: 4, teacher: "نورة المعلمة", subject: "الإنجليزية", title: "تحضير درس القواعد", date: "2023-10-17", status: "pending" }
        ];

        // متغيرات عامة
        let currentLanguage = localStorage.getItem('currentLanguage') || 'ar';
        let darkMode = localStorage.getItem('darkMode') === 'true';
        let currentChart = null; // لتتبع الرسم البياني الحالي

        // استعادة معلومات المستخدم
        const currentUser = JSON.parse(localStorage.getItem('currentUser') || '{}');

        // تحديث اتجاه الصفحة واللغة والوضع الداكن
        document.body.className = currentLanguage === 'ar' ? 'rtl' : 'ltr';
        if (darkMode) {
            document.body.classList.add('dark-mode');
        }

        // تحديث معلومات المستخدم في الصفحة
        if (currentUser.name) {
            document.getElementById('user-name').textContent = currentLanguage === 'ar' ? currentUser.name : currentUser.nameEn;
        }

        // إعداد زر الوضع الداكن
        document.querySelectorAll('#header-dark-mode-toggle, #sidebar-dark-mode-toggle').forEach(btn => {
            btn.addEventListener('click', function () {
                darkMode = !darkMode;
                localStorage.setItem('darkMode', darkMode);

                if (darkMode) {
                    document.body.classList.add('dark-mode');
                } else {
                    document.body.classList.remove('dark-mode');
                }

                updateDarkModeText();
            });
        });

        // إعداد زر تسجيل الخروج
        document.getElementById('logout-link').addEventListener('click', function (e) {
            e.preventDefault();
            localStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        });

        document.getElementById('header-logout-btn').addEventListener('click', function () {
            localStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        });

        // وظائف فتح النوافذ المنبثقة
        function openUsersModal() {
            document.getElementById('users-modal').style.display = 'flex';
            loadUsersList();
        }

        function openReportsModal() {
            document.getElementById('reports-modal').style.display = 'flex';
            loadReportsChart();
        }

        function openPrepReviewModal() {
            document.getElementById('prep-review-modal').style.display = 'flex';
            loadPrepList();
        }

        function openSettingsModal() {
            document.getElementById('settings-modal').style.display = 'flex';
        }

        function openScheduleModal() {
            document.getElementById('schedule-modal').style.display = 'flex';
            loadScheduleTable();
        }

        function openMessagingModal() {
            document.getElementById('messaging-modal').style.display = 'flex';
        }

        // وظيفة إغلاق النوافذ المنبثقة
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // إغلاق النوافذ المنبثقة عند النقر خارجها
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function (e) {
                if (e.target === this) {
                    this.style.display = 'none';
                }
            });
        });

        // تحديث النصوص حسب اللغة الحالية
        function updateLanguage() {
            const translations = {
                'ar': {
                    'header-title': 'لوحة تحكم المدير - نظام DT Edu',
                    'menu-dashboard': 'لوحة التحكم',
                    'menu-users': 'إدارة المستخدمين',
                    'menu-reports': 'التقارير والإحصائيات',
                    'menu-schedule': 'الجدول المدرسي',
                    'menu-settings': 'إعدادات النظام',
                    'menu-messages': 'الرسائل',
                    'admin-students-stat': 'عدد المستخدمين',
                    'admin-teachers-stat': 'عدد الدورات',
                    'admin-classes-stat': 'عدد التسجيلات',
                    'admin-performance-stat': 'عدد الرسائل',
                    'admin-users-card': 'إدارة المستخدمين',
                    'admin-users-desc': 'إدارة حسابات الطلاب والمعلمين وأولياء الأمور.',
                    'admin-reports-card': 'التقارير والإحصائيات',
                    'admin-reports-desc': 'عرض التقارير والإحصائيات الشاملة للمدرسة.',
                    'admin-prep-card': 'مراجعة التحضير',
                    'admin-prep-desc': 'مراجعة وتحضير الدروس المرفوعة من المعلمين.',
                    'admin-settings-card': 'إعدادات النظام',
                    'admin-settings-desc': 'إعدادات النظام العامة وإدارة الصلاحيات.',
                    'admin-schedule-card': 'الجدول المدرسي',
                    'admin-schedule-desc': 'إدارة الجداول الدراسية وتوزيع الحصص.',
                    'admin-messaging-card': 'التواصل',
                    'admin-messaging-desc': 'التواصل مع المعلمين والطلاب وأولياء الأمور.',
                    'reports-title': 'التقارير الشاملة',
                    'reports-desc': 'قم بمراجعة التقارير الشاملة للمدرسة وإحصائيات الأداء للطلاب والمعلمين.',
                    'reports-btn': 'عرض التقارير الشاملة',
                    'logout-text': 'تسجيل الخروج',
                    'header-logout-text': 'تسجيل الخروج',
                    'dark-mode-text': 'الوضع الداكن',
                    'dark-mode-btn-text': 'الوضع الداكن',
                    'users-title': 'إدارة المستخدمين',
                    'reports-modal-title': 'التقارير والإحصائيات',
                    'prep-review-title': 'مراجعة التحضير',
                    'settings-title': 'إعدادات النظام',
                    'schedule-title': 'إدارة الجدول المدرسي',
                    'messaging-title': 'التواصل'
                },
                'en': {
                    'header-title': 'Admin Dashboard - DT Edu System',
                    'menu-dashboard': 'Dashboard',
                    'menu-users': 'Users Management',
                    'menu-reports': 'Reports & Statistics',
                    'menu-schedule': 'School Schedule',
                    'menu-settings': 'System Settings',
                    'menu-messages': 'Messages',
                    'admin-students-stat': 'Students Count',
                    'admin-teachers-stat': 'Teachers Count',
                    'admin-classes-stat': 'Classes Count',
                    'admin-performance-stat': 'Performance Rate',
                    'admin-users-card': 'Users Management',
                    'admin-users-desc': 'Manage student, teacher, and parent accounts.',
                    'admin-reports-card': 'Reports & Statistics',
                    'admin-reports-desc': 'View comprehensive school reports and statistics.',
                    'admin-prep-card': 'Preparation Review',
                    'admin-prep-desc': 'Review and approve lesson plans uploaded by teachers.',
                    'admin-settings-card': 'System Settings',
                    'admin-settings-desc': 'General system settings and permissions management.',
                    'admin-schedule-card': 'School Schedule',
                    'admin-schedule-desc': 'Manage academic schedules and class distribution.',
                    'admin-messaging-card': 'Communication',
                    'admin-messaging-desc': 'Communicate with teachers, students, and parents.',
                    'reports-title': 'Comprehensive Reports',
                    'reports-desc': 'Review comprehensive school reports and performance statistics for students and teachers.',
                    'reports-btn': 'View Comprehensive Reports',
                    'logout-text': 'Logout',
                    'header-logout-text': 'Logout',
                    'dark-mode-text': 'Dark Mode',
                    'dark-mode-btn-text': 'Dark Mode',
                    'users-title': 'Users Management',
                    'reports-modal-title': 'Reports & Statistics',
                    'prep-review-title': 'Preparation Review',
                    'settings-title': 'System Settings',
                    'schedule-title': 'School Schedule Management',
                    'messaging-title': 'Communication'
                }
            };

            Object.keys(translations[currentLanguage]).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.textContent = translations[currentLanguage][key];
                }
            });
        }

        // تحديث نص زر الوضع الداكن
        function updateDarkModeText() {
            const darkModeText = currentLanguage === 'ar'
                ? (darkMode ? 'الوضع الفاتح' : 'الوضع الداكن')
                : (darkMode ? 'Light Mode' : 'Dark Mode');

            document.getElementById('dark-mode-text').textContent = darkModeText;
            document.getElementById('dark-mode-btn-text').textContent = darkModeText;

            const icons = document.querySelectorAll('#header-dark-mode-toggle i, #sidebar-dark-mode-toggle i');
            icons.forEach(icon => {
                icon.className = darkMode ? 'fas fa-sun' : 'fas fa-moon';
            });
        }

        // تحميل قائمة المستخدمين مع التصفية
        function loadUsersList() {
            const filterValue = document.getElementById('user-type-filter').value;
            const usersList = document.getElementById('users-list');
            usersList.innerHTML = '';

            const filteredUsers = filterValue === 'all'
                ? users
                : users.filter(user => user.type === filterValue);

            filteredUsers.forEach(user => {
                const item = document.createElement('li');
                item.className = 'content-item';

                const typeText = {
                    'student': 'طالب',
                    'teacher': 'معلم',
                    'parent': 'ولي أمر'
                };

                const statusText = {
                    'active': 'نشط',
                    'inactive': 'غير نشط'
                };

                item.innerHTML = `
                    <div class="content-name">${user.name}</div>
                    <div class="content-meta">
                        <span>النوع: ${typeText[user.type]}</span>
                        <span>${user.class ? `الصف: ${user.class}` : ''}</span>
                        <span>${user.subject ? `المادة: ${user.subject}` : ''}</span>
                        <span>${user.student ? `الطالب: ${user.student}` : ''}</span>
                        <span>الحالة: ${statusText[user.status]}</span>
                    </div>
                    <div class="content-actions">
                        <button class="content-btn" onclick="editUser(${user.id})">تعديل</button>
                        <button class="content-btn" onclick="toggleUserStatus(${user.id})">${user.status === 'active' ? 'تعطيل' : 'تفعيل'}</button>
                    </div>
                `;
                usersList.appendChild(item);
            });
        }

        // تحميل الرسم البياني للتقارير مع التصفية الديناميكية
        function loadReportsChart() {
            const reportType = document.getElementById('report-type').value;
            const reportPeriod = document.getElementById('report-period').value;
            const ctx = document.getElementById('reports-chart').getContext('2d');

            // تدمير الرسم البياني السابق إذا كان موجوداً
            if (currentChart) {
                currentChart.destroy();
            }

            let data, labels, datasets;

            // بيانات مختلفة حسب نوع التقرير والفترة
            if (reportType === 'performance') {
                if (reportPeriod === 'week') {
                    labels = ['اليوم 1', 'اليوم 2', 'اليوم 3', 'اليوم 4', 'اليوم 5', 'اليوم 6', 'اليوم 7'];
                    data = [75, 78, 82, 80, 85, 88, 90];
                } else if (reportPeriod === 'month') {
                    labels = ['الأسبوع 1', 'الأسبوع 2', 'الأسبوع 3', 'الأسبوع 4'];
                    data = [78, 82, 85, 88];
                } else {
                    labels = ['الشهر 1', 'الشهر 2', 'الشهر 3', 'الشهر 4', 'الشهر 5', 'الشهر 6'];
                    data = [75, 78, 80, 82, 85, 88];
                }
                datasets = [{
                    label: 'معدل الأداء',
                    data: data,
                    backgroundColor: 'rgba(74, 108, 247, 0.5)',
                    borderColor: 'rgba(74, 108, 247, 1)',
                    borderWidth: 1
                }];
            } else if (reportType === 'attendance') {
                if (reportPeriod === 'week') {
                    labels = ['اليوم 1', 'اليوم 2', 'اليوم 3', 'اليوم 4', 'اليوم 5', 'اليوم 6', 'اليوم 7'];
                    data = [85, 88, 90, 92, 87, 89, 91];
                } else if (reportPeriod === 'month') {
                    labels = ['الأسبوع 1', 'الأسبوع 2', 'الأسبوع 3', 'الأسبوع 4'];
                    data = [87, 89, 91, 93];
                } else {
                    labels = ['الشهر 1', 'الشهر 2', 'الشهر 3', 'الشهر 4', 'الشهر 5', 'الشهر 6'];
                    data = [85, 87, 89, 91, 93, 95];
                }
                datasets = [{
                    label: 'معدل الحضور',
                    data: data,
                    backgroundColor: 'rgba(0, 184, 148, 0.5)',
                    borderColor: 'rgba(0, 184, 148, 1)',
                    borderWidth: 1
                }];
            } else if (reportType === 'teachers') {
                if (reportPeriod === 'week') {
                    labels = ['المعلم 1', 'المعلم 2', 'المعلم 3', 'المعلم 4', 'المعلم 5'];
                    data = [88, 92, 85, 90, 87];
                } else if (reportPeriod === 'month') {
                    labels = ['المعلم 1', 'المعلم 2', 'المعلم 3', 'المعلم 4', 'المعلم 5'];
                    data = [90, 94, 87, 92, 89];
                } else {
                    labels = ['المعلم 1', 'المعلم 2', 'المعلم 3', 'المعلم 4', 'المعلم 5'];
                    data = [92, 96, 89, 94, 91];
                }
                datasets = [{
                    label: 'أداء المعلمين',
                    data: data,
                    backgroundColor: 'rgba(253, 121, 168, 0.5)',
                    borderColor: 'rgba(253, 121, 168, 1)',
                    borderWidth: 1
                }];
            } else if (reportType === 'financial') {
                if (reportPeriod === 'week') {
                    labels = ['الإيرادات', 'المصروفات'];
                    data = [15000, 12000];
                } else if (reportPeriod === 'month') {
                    labels = ['الإيرادات', 'المصروفات'];
                    data = [60000, 48000];
                } else {
                    labels = ['الإيرادات', 'المصروفات'];
                    data = [720000, 576000];
                }
                datasets = [{
                    label: 'التقارير المالية',
                    data: data,
                    backgroundColor: ['rgba(253, 203, 110, 0.5)', 'rgba(231, 76, 60, 0.5)'],
                    borderColor: ['rgba(253, 203, 110, 1)', 'rgba(231, 76, 60, 1)'],
                    borderWidth: 1
                }];
            }

            currentChart = new Chart(ctx, {
                type: reportType === 'financial' ? 'doughnut' : 'line',
                data: {
                    labels: labels,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'التقارير والإحصائيات'
                        }
                    }
                }
            });
        }

        // تحميل قائمة التحضيرات
        function loadPrepList() {
            const filterValue = document.getElementById('prep-filter').value;
            const prepList = document.getElementById('prep-list');
            prepList.innerHTML = '';

            const filteredPrep = filterValue === 'all'
                ? preparationMaterials
                : preparationMaterials.filter(item => item.status === filterValue);

            filteredPrep.forEach(item => {
                const listItem = document.createElement('li');
                listItem.className = 'content-item';

                const statusText = {
                    'pending': 'في انتظار المراجعة',
                    'approved': 'تمت الموافقة',
                    'rejected': 'مرفوض'
                };

                const statusClass = {
                    'pending': 'status-late',
                    'approved': 'status-present',
                    'rejected': 'status-absent'
                };

                listItem.innerHTML = `
                    <div class="content-name">${item.title}</div>
                    <div class="content-meta">
                        <span>المعلم: ${item.teacher}</span>
                        <span>المادة: ${item.subject}</span>
                        <span>التاريخ: ${item.date}</span>
                        <span class="status-btn ${statusClass[item.status]}">${statusText[item.status]}</span>
                    </div>
                    <div class="content-actions">
                        <button class="content-btn" onclick="viewPrep(${item.id})">عرض</button>
                        <button class="content-btn" onclick="approvePrep(${item.id})">موافقة</button>
                        <button class="content-btn" onclick="rejectPrep(${item.id})">رفض</button>
                    </div>
                `;
                prepList.appendChild(listItem);
            });
        }

        // تحميل جدول الجدول المدرسي
        function loadScheduleTable() {
            const scheduleTableBody = document.getElementById('schedule-table-body');
            scheduleTableBody.innerHTML = '';

            const days = ['السبت', 'الأحد', 'الاثنين', 'الثلاثاء', 'الأربعاء', 'الخميس'];
            const subjects = ['الرياضيات', 'اللغة العربية', 'العلوم', 'الإنجليزية', 'التربية الإسلامية', 'التربية الفنية'];

            days.forEach(day => {
                const row = document.createElement('tr');
                row.innerHTML = `<td>${day}</td>`;
                for (let i = 0; i < 5; i++) {
                    const subject = subjects[Math.floor(Math.random() * subjects.length)];
                    row.innerHTML += `<td>${subject}</td>`;
                }
                scheduleTableBody.appendChild(row);
            });
        }

        // وظائف إضافية للمستخدمين
        function openAddUserModal() {
            document.getElementById('add-user-modal').style.display = 'flex';
            // إخفاء جميع الحقول الإضافية أولاً
            document.getElementById('class-group').style.display = 'none';
            document.getElementById('subject-group').style.display = 'none';
            document.getElementById('student-group').style.display = 'none';

            // إضافة event listener لتغيير نوع المستخدم
            document.getElementById('new-user-type').addEventListener('change', function () {
                const userType = this.value;
                document.getElementById('class-group').style.display = userType === 'student' ? 'block' : 'none';
                document.getElementById('subject-group').style.display = userType === 'teacher' ? 'block' : 'none';
                document.getElementById('student-group').style.display = userType === 'parent' ? 'block' : 'none';
            });
        }

        function addNewUser() {
            const name = document.getElementById('new-user-name').value;
            const email = document.getElementById('new-user-email').value;
            const type = document.getElementById('new-user-type').value;

            if (!name || !email || !type) {
                alert('يرجى ملء جميع الحقول المطلوبة');
                return;
            }

            const newUser = {
                id: users.length + 1,
                name: name,
                type: type,
                status: 'active'
            };

            if (type === 'student') {
                newUser.class = document.getElementById('new-user-class').value;
            } else if (type === 'teacher') {
                newUser.subject = document.getElementById('new-user-subject').value;
            } else if (type === 'parent') {
                newUser.student = document.getElementById('new-user-student').value;
            }

            users.push(newUser);

            // إغلاق النافذة المنبثقة وتحديث القائمة
            closeModal('add-user-modal');
            loadUsersList();

            // مسح الحقول
            document.getElementById('new-user-name').value = '';
            document.getElementById('new-user-email').value = '';
            document.getElementById('new-user-type').value = 'student';
            document.getElementById('new-user-class').value = '';
            document.getElementById('new-user-subject').value = '';
            document.getElementById('new-user-student').value = '';

            alert('تم إضافة المستخدم بنجاح');
        }

        function editUser(userId) {
            const user = users.find(u => u.id === userId);
            if (user) {
                alert(`تعديل المستخدم: ${user.name}`);
                // يمكن إضافة منطق التعديل هنا
            }
        }

        function toggleUserStatus(userId) {
            const user = users.find(u => u.id === userId);
            if (user) {
                user.status = user.status === 'active' ? 'inactive' : 'active';
                loadUsersList();
            }
        }

        // وظائف التحضير
        function viewPrep(prepId) {
            const prep = preparationMaterials.find(p => p.id === prepId);
            if (prep) {
                alert(`عرض التحضير: ${prep.title}`);
            }
        }

        function approvePrep(prepId) {
            const prep = preparationMaterials.find(p => p.id === prepId);
            if (prep) {
                prep.status = 'approved';
                loadPrepList();
            }
        }

        function rejectPrep(prepId) {
            const prep = preparationMaterials.find(p => p.id === prepId);
            if (prep) {
                prep.status = 'rejected';
                loadPrepList();
            }
        }

        // وظيفة تعديل الجدول
        function editSchedule() {
            alert('فتح نافذة تعديل الجدول المدرسي');
        }

        // وظيفة حفظ الإعدادات
        function saveSettings() {
            const systemName = document.getElementById('system-name').value;
            const schoolName = document.getElementById('school-name').value;
            const academicYear = document.getElementById('academic-year').value;
            const language = document.getElementById('language-setting').value;

            // حفظ الإعدادات في localStorage
            localStorage.setItem('systemName', systemName);
            localStorage.setItem('schoolName', schoolName);
            localStorage.setItem('academicYear', academicYear);
            localStorage.setItem('currentLanguage', language);

            // تحديث اللغة إذا تغيرت
            if (language !== currentLanguage) {
                currentLanguage = language;
                updateLanguage();
                document.body.className = currentLanguage === 'ar' ? 'rtl' : 'ltr';
            }

            alert('تم حفظ الإعدادات بنجاح');
            closeModal('settings-modal');
        }

        // وظيفة إرسال الرسالة
        function sendMessage() {
            const recipient = document.getElementById('message-recipient').value;
            const subject = document.getElementById('message-subject').value;
            const content = document.getElementById('message-content').value;

            if (!recipient || !subject || !content) {
                alert('يرجى ملء جميع الحقول');
                return;
            }

            // محاكاة إرسال الرسالة
            alert('تم إرسال الرسالة بنجاح');

            // مسح الحقول
            document.getElementById('message-recipient').value = '';
            document.getElementById('message-subject').value = '';
            document.getElementById('message-content').value = '';

            closeModal('messaging-modal');
        }

        // تحديث الإحصائيات
        function updateStats() {
            document.getElementById('users-count').textContent = users.length;
            document.getElementById('courses-count').textContent = '12'; // قيمة ثابتة للمثال
            document.getElementById('enrollments-count').textContent = '156'; // قيمة ثابتة للمثال
            document.getElementById('messages-count').textContent = '23'; // قيمة ثابتة للمثال
        }

        // استدعاء الوظائف عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', function () {
            updateLanguage();
            updateDarkModeText();
            updateStats();

            // إضافة event listeners للتصفية الديناميكية
            document.getElementById('user-type-filter').addEventListener('change', loadUsersList);
            document.getElementById('prep-filter').addEventListener('change', loadPrepList);
            document.getElementById('report-type').addEventListener('change', loadReportsChart);
            document.getElementById('report-period').addEventListener('change', loadReportsChart);
        });
    </script>
</body>

</html>